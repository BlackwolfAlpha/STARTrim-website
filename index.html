<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STARTrimCommunity</title>
    <link rel="stylesheet" href="design/style.css">
    <link rel="stylesheet" href="design/eventcard.css">
</head>
<body>

<div class="background">
    <div class="navbar">
        <div class="menu">
            <div class="logo">
                <img src="design/Logos/startrimlogo.png" alt="STARTrim Logo">
            </div>
            <ul>
                <li><a href="index.html" data-translate="HOME">HOME</a></li>
                <li><a href="Contact.html" data-translate="CONTACT">CONTACT</a></li>
                <li><a href="#" id="toggle-login-signup" data-translate="Login/SignUp">Login/SignUp</a></li>
            </ul>

            <div class="language-selector">
                <select id="language-select">
                    <option value="en">English</option>
                    <option value="he">עברית</option>
                </select>
            </div>
        </div>

        <div class="content">
            <div class="logo-container">
                <img src="design/Logos/startrimlogo.png" alt="STARTrim Logo" class="logo">
            </div>
            <h1 data-translate="INNOVATION_ENTREPRENEURSHIP_TECHNOLOGY_COURSE">Innovation & <br><span>Entrepreneurship</span> <br>And technology course</h1>
            <p class="par" data-translate="COMMUNITY_DESCRIPTION">
                <br> The "STARTrim" community brings together young men and women from all over the country
                <br> who are interested in the fields of entrepreneurship, technology, and personal development.
                <br> In the community we place a lot of emphasis on providing value for community members,
                <br> we hold a monthly event on various topics and create content on the community's virtual channel.
                <br> The community is a home for the sons and daughters of the youth in Israel designed to
                <br> create a place for connection and learning in order to nurture the future generation
                <br> of the State of Israel.
            </p>

            <div id="login-signup-container" style="display: none;">
                <div class="form">
                    <form id="login-form">
                        <input type="email" id="email" name="email" placeholder="Enter Email Here">
                        <input type="password" id="password" name="password" placeholder="Enter Password Here">
                        <button type="submit" class="btnn">Login</button>
                    </form>

                    <p class="link" data-translate="NO_ACCOUNT">Don't have an account<br>
                        <a href="signup.html" data-translate="SIGN_UP">Sign up </a><a data-translate="HERE"> here</a></p>
                    <p class="liw" data-translate="LOGIN_WITH">Log in with</p>

                    <div class="icons">
                        <a href="#"><ion-icon name="logo-facebook"></ion-icon></a>
                        <a href="#"><ion-icon name="logo-instagram"></ion-icon></a>
                        <a href="#" onclick="signInWithGoogle()"><ion-icon name="logo-google"></ion-icon></a>
                    </div>
                </div>
            </div>
        </div>

        <div class="container scroll-1">
            <div class="card">
                <div class="card__image" data-title="Microsoft Reactor">
                    <img src="design/eventsphoto/Microsoft Reactor.png" alt="Microsoft Reactor">
                </div>
                <div class="card__content">
                    <span class="card__title">Microsoft Reactor</span>
                    <p class="card__describe">
                        Description for Event 1
                    </p>
                </div>
            </div>
            <div class="card">
                <div class="card__image" data-title="Herzliya">
                    <img src="design/eventsphoto/Herzliya.jpg" alt="Herzliya">
                </div>
                <div class="card__content">
                    <span class="card__title">Herzliya</span>
                    <p class="card__describe">
                        Description for Event 2
                    </p>
                </div>
            </div>
            <div class="card">
                <div class="card__image" data-title="Haifa technion">
                    <img src="design/eventsphoto/Haifa technion.jpeg" alt="Haifa technion">
                </div>
                <div class="card__content">
                    <span class="card__title">Haifa technion</span>
                    <p class="card__describe">
                        Description for Event 3
                    </p>
                </div>
            </div>
            <div class="card">
                <div class="card__image" data-title="Event 4">
                    <img src="design/eventsphoto/" alt="Event 4">
                </div>
                <div class="card__content">
                    <span class="card__title">Event 4</span>
                    <p class="card__describe">
                        Description for Event 4
                    </p>
                </div>
            </div>
        </div>

        <div class="card_comment">
            <div class="bar_comment"></div>
            <div class="card_form_comment">
                <img id="dynamic-image" src="" alt="commants">
            </div>
            <div class="card_data_comment">
                <div class="data_comment">
                    <div class="text_comment">
                        <label class="text_m_comment" data-translate="Main Title">Main Title</label>
                        <div class="cube text_s_comment" id="cube">
                            <label class="side front_comment" data-translate="Access the list (Topic)">Access the list (Topic)</label>
                            <label class="side top_comment" data-translate="Username-id">Username-id</label>
                        </div>
                        <label class="text_d_comment" data-translate="Translation_responses">Description</label>
                    </div>
                </div>
            </div>
        </div>


        <footer class="footer">
            <p>&copy; 2024 STARTrimCommunity. All rights reserved.</p>
            <p>Created by Avital Gladkih</p>
        </footer>

    </div>
</div>

<script src="https://unpkg.com/ionicons@5.4.0/dist/ionicons.js"></script>
<script src="https://apis.google.com/js/platform.js" async defer></script>
<meta name="807118098633-d61d9q5sn9bn4pr1s3kn6hloqgbivli1.apps.googleusercontent.com"
      content="807118098633-bpclon7bnhbspvg9n43c2vksb3s7un0f.apps.googleusercontent.com">
<script>
    var container = document.querySelector('.container');

    container.addEventListener('wheel', function (event) {
        if (event.deltaY !== 0) {
            event.preventDefault();
            container.scrollLeft += event.deltaY;
        }
    });

    document.getElementById('toggle-login-signup').addEventListener('click', function() {
        var loginSignupContainer = document.getElementById('login-signup-container');
        if (loginSignupContainer.style.display === 'none') {
            loginSignupContainer.style.display = 'block';
        } else {
            loginSignupContainer.style.display = 'none';
        }
    });

    document.getElementById('language-select').addEventListener('change', function () {
        var selectedLanguage = this.value;
        changeLanguage(selectedLanguage);
    });

    function changeLanguage(selectedLanguage) {
        fetch('Language/' + selectedLanguage + '.json')
            .then(response => response.json())
            .then(data => {
                document.querySelectorAll('[data-translate]').forEach(element => {
                    const key = element.getAttribute('data-translate');
                    if (data[key]) {
                        if (selectedLanguage === 'he' && containsHebrewText(data[key])) {
                            element.setAttribute('dir', 'rtl');
                        } else if (selectedLanguage === 'en' && containsEnglishText(data[key])) {
                            element.setAttribute('dir', 'ltr');
                        }
                        element.innerHTML = data[key];
                    }
                });
            })
            .catch(error => console.error('Error fetching language file:', error));
    }

    function containsHebrewText(text) {
        const hebrewRegex = /[\u0590-\u05FF\uFB1D-\uFB4F]/;
        return hebrewRegex.test(text);
    }

    function containsEnglishText(text) {
        const englishRegex = /[a-zA-Z]/;
        return englishRegex.test(text);
    }

    document.addEventListener('DOMContentLoaded', function () {
        changeLanguage(document.getElementById('language-select').value);
    });

    function directSignIn(email) {
        setUserDataInCookie(email);
        window.location.href = 'STARTrimHOME.html';
    }

    function signInWithGoogle() {
        gapi.load('auth2', function () {
            var auth2 = gapi.auth2.init({
                client_id: '807118098633-d61d9q5sn9bn4pr1s3kn6hloqgbivli1.apps.googleusercontent.com',
                cookiepolicy: 'single_host_origin'
            });

            auth2.signIn().then(function (googleUser) {
                var profile = googleUser.getBasicProfile();
                var email = profile.getEmail();

                fetchDataFromGoogleSheet().then(function(data) {
                    var rowIndex = findRowByEmail(email, data);
                    if (rowIndex !== -1) {
                        setUserDataInCookie(email);
                        window.location.href = 'STARTrimHOME.html';
                    } else {
                        directSignIn(email);
                    }
                }).catch(function(error) {
                    console.error('Error fetching data:', error);
                });
            }, function (error) {
                console.log(error);
            });
        });
    }

    async function fetchDataFromGoogleSheet() {
        try {
            const response = await fetch('https://sheets.googleapis.com/v4/spreadsheets/1WrsrKtGqjdwbaL20Cs7TmScQNVp5kJRKcN0P6wHmdko/values/signupSTARTrim-form!A:J?key=AIzaSyAYSge_Rg_xblZbyj9vHdhMJzZOrGFylqI');
            if (!response.ok) {
                throw new Error('Failed to fetch data');
            }
            const data = await response.json();
            return data.values;
        } catch (error) {
            console.error('Error fetching data:', error.message);
            return null;
        }
    }

    function findRowByEmail(email, data) {
        if (!data) return -1;

        for (let i = 0; i < data.length; i++) {
            const row = data[i];
            if (row[0] === email) {
                return i + 1;
            }
        }
        return -1;
    }

    function setUserDataInCookie(username) {
        document.cookie = "username=" + username + ";path=/";
    }

    function getUserDataFromCookie() {
        var name = "username=";
        var decodedCookie = decodeURIComponent(document.cookie);
        var cookieArray = decodedCookie.split(';');
        for (var i = 0; i < cookieArray.length; i++) {
            var cookie = cookieArray[i];
            while (cookie.charAt(0) == ' ') {
                cookie = cookie.substring(1);
            }
            if (cookie.indexOf(name) == 0) {
                return cookie.substring(name.length, cookie.length);
            }
        }
        return "";
    }

    document.getElementById('login-form').addEventListener('submit', async function (event) {
        event.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        const data = await fetchDataFromGoogleSheet();
        const rowIndex = findRowByEmail(email, data);

        if (rowIndex !== -1) {
            const row = data[rowIndex - 1];
            const storedEmail = row[0];
            const storedPassword = row[3];

            if (email === storedEmail && password === storedPassword) {
                setUserDataInCookie(email);
                window.location.href = 'STARTrimHOME.html';
            } else {
                alert('Incorrect email or password. Please try again.');
            }
        } else {
            alert('Incorrect email or password. Please try again.');
        }
    });

    const imagesData = [
        {
            imageUrl: "design/commants/nikol.jpg",
            username: "Nikol",
            description: "Description for Nikol"
        },
        {
            imageUrl: "תמונה_שנייה.jpg",
            username: "שם משתמש 2",
            description: "תיאור לתמונה השנייה"
        },
    ];


    let currentImageIndex = 0;
    const dynamicImage = document.getElementById("dynamic-image");

    function changeImage() {
        dynamicImage.src = imagesData[currentImageIndex].imageUrl;
        document.querySelector('.side.top_comment').textContent = imagesData[currentImageIndex].username;
        document.querySelector('.text_d_comment').textContent = imagesData[currentImageIndex].description;
        currentImageIndex = (currentImageIndex + 1) % imagesData.length;
    }

    setInterval(changeImage, 8000);
</script>
</body>
</html>
