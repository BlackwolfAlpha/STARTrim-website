<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STARTrimCommunity</title>
    <link rel="icon" type="image/x-icon" href="design/Logos/x-STARTrimlogo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&family=Suez+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="design/style.css">
    <link rel="stylesheet" href="design/CSS_files/eventcard.css">
    <link rel="stylesheet" href="design/CSS_files/media.css">
</head>
<body>

<div class="background">
    <div class="navbar">
        <div class="menu-icon" onclick="toggleMenu()">&#9776;</div>
        <header>
            <div class="menu">
                <div class="logo">
                    <a href="index.html">
                        <img src="design/Logos/startrimlogo.png" alt="STARTrim Logo">
                    </a>
                </div>
                <ul>
                    <li><a href="#" data-translate="Events">Events</a></li>
                    <li><a href="Contact.html" data-translate="CONTACT">CONTACT</a></li>
                    <li><a href="#" id="toggle-login-signup" data-translate="Login/SignUp">Login/SignUp</a></li>
                </ul>

                <div class="language-selector">
                    <select id="language-select">
                        <option value="en">English</option>
                        <option value="he">עברית</option>
                    </select>
                </div>
            </div>
        </header>

        <div id="side-menu" class="side-menu">
            <a href="javascript:void(0)" class="closebtn" onclick="toggleMenu()">&times;</a>
            <a href="#" data-translate="Events">Events</a>
            <a href="Contact.html" data-translate="CONTACT">CONTACT</a>
            <a href="#" id="toggle-login-signup2" data-translate="Login/SignUp">Login/SignUp</a>
            <div class="language-selector">
                <select id="language-select2">
                    <option value="en">English</option>
                    <option value="he">עברית</option>
                </select>
            </div>
        </div>

        <div class="content">
            <div class="logo-container">
                <img src="design/Logos/main farme STARTrim.png" alt="STARTrim Logo" class="main_logo">
            </div>
            <div class="content_info">
                <h1 data-translate="INNOVATION_ENTREPRENEURSHIP_TECHNOLOGY_COURSE">Welcome to STARTrim community</h1>
                <p class="par" data-translate="COMMUNITY_DESCRIPTION">
                    <br> "Description..."
                </p>
            </div>

            <div id="login-signup-container" style="display: none;">
                <div class="form">
                    <form id="login-form">
                        <input type="email" id="email" name="email" placeholder="Enter Email Here" data-translate="ENTER_EMAIL">
                        <input type="password" id="password" name="password" placeholder="Enter Password Here" data-translate="ENTER_PASSWORD">
                        <button type="submit" class="btnn" data-translate="LOGIN">Login </button>
                    </form>

                    <p class="link" data-translate="NO_ACCOUNT">Don't have an account<br>
                        <a href="signup.html" data-translate="SIGN_UP">Sign up </a><a data-translate="HERE"> here</a></p>
                    <p class="liw" data-translate="LOGIN_WITH">Log in with</p>

                    <div class="icons">
                        <a href="#" onclick="signInWithGoogle()"><ion-icon name="logo-google"></ion-icon></a>
                    </div>
                </div>
            </div>
        </div>

        <div class="events-section">
            <h2 class="events-title" data-translate="Event_title">Our events:</h2>
            <div class="scroll-container">
                <button class="scroll-btn left">&#9664;</button>
                <div class="container scroll-1" id="events-container">
                    <!-- Dynamic events will be inserted here -->
                </div>
                <button class="scroll-btn right">&#9654;</button>
            </div>
        </div>

        <div class="content_comment">
            <a href="signup.html" class="par-link">
                <p class="par" data-translate="want_to_share_comment">
                    <br> Want to publish your comment?
                    <br> Contact us by email: startrim1213@gmail.com
                </p>
            </a>
        </div>

        <div class="card_comment">
            <div class="bar_comment"></div>
            <div class="card_form_comment">
                <img id="dynamic-image" class="comment-image" src="" alt="comments">
            </div>
            <div class="card_data_comment">
                <div class="data_comment">
                    <div class="text_comment">
                        <div class="cube text_s_comment" id="cube">
                            <label class="side front_comment" data-translate="Access the list (Topic)"></label>
                            <label class="side top_comment" data-translate="Username-id"></label>
                        </div>
                        <label class="text_d_comment" data-translate="Translation_responses"></label>
                    </div>
                </div>
            </div>
        </div>

        <section class="partners">
            <h2 class="partners-title" data-translate="partners-title">Our Partners:</h2>
            <div class="partners-container">
                <button class="scroll-button prev-button" disabled>&#9664;</button>
                <div class="partner">
                    <img src="design/Partners logo/aws logo.png" alt="Partner 1">
                </div>
                <div class="partner">
                    <img src="design/Partners logo/TEENK logo.png" alt="Partner 2">
                </div>
                <div class="partner">
                    <img src="design/Partners logo/gav-yam_logo.png" alt="Partner 3">
                </div>
                <div class="partner">
                    <img src="design/Partners logo/technion_logo.png" alt="Partner 4">
                </div>
                <div class="partner">
                    <img src="design/Partners logo/microsoft logo.png" alt="Partner 5">
                </div>
                <div class="partner" style="display:none;">
                    <img src="design/Partners logo/MIXER logo.png" alt="Partner 6">
                </div>
                <div class="partner" style="display:none;">
                    <img src="design/Partners logo/the_innovation logo.png" alt="Partner 7">
                </div>
                <div class="partner" style="display:none;">
                    <img src="design/Partners logo/Herzliya logo.png" alt="Partner 8">
                </div>
                <div class="partner" style="display:none;">
                    <img src="design/Partners logo/tech4ed logo.png" alt="Partner 9">
                </div>
                <button class="scroll-button next-button">&#9654;</button>
            </div>
        </section>

        <br>
        <footer class="footer">
            <p>&copy; 2024 STARTrimCommunity. All rights reserved.</p>
            <p>Created by Avital Gladkih</p>
        </footer>
    </div>
</div>

<script type="module" src="https://unpkg.com/ionicons@5.4.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule="" src="https://unpkg.com/ionicons@5.4.0/dist/ionicons/ionicons.js"></script>
<script src="https://apis.google.com/js/platform.js" async defer></script>
<meta name="807118098633-d61d9q5sn9bn4pr1s3kn6hloqgbivli1.apps.googleusercontent.com"
      content="807118098633-bpclon7bnhbspvg9n43c2vksb3s7un0f.apps.googleusercontent.com">
<script src="java script/Partners-scroll.js"></script>
<script src="java script/toggleMenu.js"></script>
<script>
    const container = document.querySelector('.container');

    container.addEventListener('wheel', function (event) {
        if (event.deltaY !== 0) {
            event.preventDefault();
            container.scrollLeft += event.deltaY;
        }
    });

    function checkHeaderPosition() {
        const header = document.querySelector('header');
        const mainLogo = document.querySelector('.main_logo');
        const logoRect = mainLogo.getBoundingClientRect();
        const headerRect = header.getBoundingClientRect();

        if (headerRect.top < logoRect.bottom && headerRect.bottom > logoRect.top) {
            header.classList.add('header-on-logo');
            header.classList.remove('header-off-logo');
        } else {
            header.classList.add('header-off-logo');
            header.classList.remove('header-on-logo');
        }
    }

    window.addEventListener('scroll', checkHeaderPosition);
    document.addEventListener('DOMContentLoaded', checkHeaderPosition);

    document.addEventListener("DOMContentLoaded", function() {
        const toggleButton = document.getElementById("toggle-login-signup");
        const loginSignupContainer = document.getElementById("login-signup-container");

        toggleButton.addEventListener("click", function(event) {
            event.preventDefault();
            if (loginSignupContainer.style.display === "none") {
                loginSignupContainer.style.display = "block";
                scrollToElement(loginSignupContainer, 380);
            } else {
                loginSignupContainer.style.display = "none";
            }
        });

        const toggleButton2 = document.getElementById("toggle-login-signup2");
        toggleButton2.addEventListener("click", function(event) {
            event.preventDefault();
            if (loginSignupContainer.style.display === "none") {
                loginSignupContainer.style.display = "block";
                scrollToElement(loginSignupContainer, 160);
            } else {
                loginSignupContainer.style.display = "none";
            }
        });
    });

    function scrollToElement(element, offset) {
        const elementPosition = element.getBoundingClientRect().top + window.pageYOffset;
        const offsetPosition = elementPosition - offset;

        window.scrollTo({
            top: offsetPosition,
            behavior: 'smooth'
        });
    }

    document.getElementById('language-select').addEventListener('change', function () {
        let selectedLanguage = this.value;
        changeLanguage(selectedLanguage);
        localStorage.setItem('preferredLanguage', selectedLanguage);
    });

    document.getElementById('language-select2').addEventListener('change', function () {
        let selectedLanguage = this.value;
        changeLanguage(selectedLanguage);
        localStorage.setItem('preferredLanguage', selectedLanguage);
    });

    function changeLanguage(selectedLanguage) {
        fetch('Data/Language/' + selectedLanguage + '.json')
            .then(response => response.json())
            .then(data => {
                document.querySelectorAll('[data-translate]').forEach(element => {
                    const key = element.getAttribute('data-translate');
                    if (data[key]) {
                        element.innerHTML = data[key];

                        if (selectedLanguage === 'he' && containsHebrewText(data[key])) {
                            document.documentElement.setAttribute('dir', 'rtl');
                        } else if (selectedLanguage === 'en') {
                            document.documentElement.setAttribute('dir', 'ltr');
                        }
                    }
                });
            })
            .catch(error => console.error('Error fetching language file:', error));
    }

    document.addEventListener('DOMContentLoaded', function () {
        const preferredLanguage = localStorage.getItem('preferredLanguage');
        if (preferredLanguage) {
            document.getElementById('language-select').value = preferredLanguage;
            document.getElementById('language-select2').value = preferredLanguage;
            changeLanguage(preferredLanguage);
        } else {
            changeLanguage(document.getElementById('language-select').value);
            changeLanguage(document.getElementById('language-select2').value);
        }
    });

    function containsHebrewText(text) {
        const hebrewRegex = /[\u0590-\u05FF\uFB1D-\uFB4F]/;
        return hebrewRegex.test(text);
    }

    function containsEnglishText(text) {
        const englishRegex = /[a-zA-Z]/;
        return englishRegex.test(text);
    }

    function alignContentCenter() {
        document.querySelectorAll('.content').forEach(content => {
            content.style.marginLeft = 'auto';
            content.style.marginRight = 'auto';
            content.style.textAlign = 'center';
        });
    }

    function directSignIn(email) {
        setUserDataInCookie(email);
        window.location.href = 'STARTrimHOME.html';
    }

    function signInWithGoogle() {
        gapi.load('auth2', function () {
            const auth2 = gapi.auth2.init({
                client_id: '807118098633-d61d9q5sn9bn4pr1s3kn6hloqgbivli1.apps.googleusercontent.com',
                cookiepolicy: 'single_host_origin'
            });

            auth2.signIn().then(function (googleUser) {
                const profile = googleUser.getBasicProfile();
                const email = profile.getEmail();

                fetchDataFromGoogleSheet().then(function(data) {
                    const rowIndex = findRowByEmail(email, data);
                    if (rowIndex !== -1) {
                        setUserDataInCookie(email);
                        window.location.href = 'STARTrimHOME.html';
                    } else {
                        directSignIn(email);
                    }
                }).catch(function(error) {
                    console.error('Error fetching data:', error);
                });
            }, function (error) {
                console.log(error);
            });
        });
    }

    async function fetchDataFromGoogleSheet() {
        try {
            const response = await fetch('https://sheets.googleapis.com/v4/spreadsheets/1WrsrKtGqjdwbaL20Cs7TmScQNVp5kJRKcN0P6wHmdko/values/signupSTARTrim-form!A:J?key=AIzaSyAYSge_Rg_xblZbyj9vHdhMJzZOrGFylqI');
            if (!response.ok) {
                throw new Error('Failed to fetch data');
            }
            const data = await response.json();
            return data.values;
        } catch (error) {
            console.error('Error fetching data:', error.message);
            return null;
        }
    }

    function findRowByEmail(email, data) {
        if (!data) return -1;

        for (let i = 0; i < data.length; i++) {
            const row = data[i];
            if (row[0] === email) {
                return i + 1;
            }
        }
        return -1;
    }

    function setUserDataInCookie(username) {
        document.cookie = "username=" + username + ";path=/";
    }

    function getUserDataFromCookie() {
        const name = "username=";
        const decodedCookie = decodeURIComponent(document.cookie);
        const cookieArray = decodedCookie.split(';');
        for (let i = 0; i < cookieArray.length; i++) {
            let cookie = cookieArray[i];
            while (cookie.charAt(0) == ' ') {
                cookie = cookie.substring(1);
            }
            if (cookie.indexOf(name) == 0) {
                return cookie.substring(name.length, cookie.length);
            }
        }
        return "";
    }


    document.getElementById('login-form').addEventListener('submit', async function (event) {
        event.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        const data = await fetchDataFromGoogleSheet();
        const rowIndex = findRowByEmail(email, data);

        if (rowIndex !== -1) {
            const row = data[rowIndex - 1];
            const storedEmail = row[0];
            const storedPassword = row[3];

            if (email === storedEmail && password === storedPassword) {
                setUserDataInCookie(email);
                window.location.href = 'STARTrimHOME.html';
            } else {
                alert('Incorrect email or password. Please try again.');
            }
        } else {
            alert('Incorrect email or password. Please try again.');
        }
    });

    document.addEventListener("DOMContentLoaded", function() {
        fetch('Data/events_info.json')
            .then(response => response.json())
            .then(events => {
                const container = document.getElementById('events-container');
                const language = localStorage.getItem('preferredLanguage') || 'en';

                events.forEach(event => {
                    const card = document.createElement('div');
                    card.classList.add('card');

                    const cardImage = document.createElement('div');
                    cardImage.classList.add('card__image');
                    cardImage.setAttribute('data-title', event.title);
                    const img = document.createElement('img');
                    img.src = event.image;
                    cardImage.appendChild(img);

                    const cardContent = document.createElement('div');
                    cardContent.classList.add('card__content');
                    const cardTitle = document.createElement('p');
                    cardTitle.classList.add('card__title');
                    cardTitle.textContent = event.title;

                    const cardDescribe = document.createElement('p');
                    cardDescribe.classList.add('card__describe');

                    const description = event.description[language] || event.description['en'];
                    cardDescribe.textContent = description || 'Description not available';

                    cardContent.appendChild(cardTitle);
                    cardContent.appendChild(cardDescribe);
                    card.appendChild(cardImage);
                    card.appendChild(cardContent);

                    container.appendChild(card);
                });
            })
            .catch(error => console.error('Error fetching events:', error));
    });


    document.addEventListener("DOMContentLoaded", function() {
        fetch('Data/Comments_info.json')
            .then(response => response.json())
            .then(imagesData => {
                let currentImageIndex = 0;
                const dynamicImage = document.getElementById("dynamic-image");
                const usernameElement = document.querySelector('.side.top_comment');
                const descriptionElement = document.querySelector('.text_d_comment');
                let interval;

                function changeImage() {
                    const language = localStorage.getItem('preferredLanguage') || 'en';
                    dynamicImage.classList.add('fade');
                    setTimeout(() => {
                        dynamicImage.src = imagesData[currentImageIndex].imageUrl;
                        usernameElement.textContent = imagesData[currentImageIndex].username[language];
                        descriptionElement.textContent = imagesData[currentImageIndex].description[language];
                        currentImageIndex = (currentImageIndex + 1) % imagesData.length;
                        dynamicImage.classList.remove('fade');
                    }, 600);
                }

                function startImageRotation() {
                    interval = setInterval(changeImage, 6000);
                }

                dynamicImage.addEventListener('mouseenter', () => clearInterval(interval));
                dynamicImage.addEventListener('mouseleave', startImageRotation);

                changeImage();
                startImageRotation();
            })
            .catch(error => console.error('Error fetching images:', error));
    });

    document.querySelector('.scroll-btn.left').addEventListener('click', () => {
        document.getElementById('events-container').scrollBy({ left: -300, behavior: 'smooth' });
    });

    document.querySelector('.scroll-btn.right').addEventListener('click', () => {
        document.getElementById('events-container').scrollBy({ left: 300, behavior: 'smooth' });
    });

</script>
</body>
</html>
